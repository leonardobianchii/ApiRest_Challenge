-- ===== V1: Tabelas de domínio (núcleo do projeto) =====

CREATE TABLE T_CM_MODELO (
  id_modelo NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nm_modelo VARCHAR2(100) NOT NULL
);

CREATE TABLE T_CM_FILIAL_DEPARTAMENTO (
  id_filial_departamento NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nm_filial_departamento VARCHAR2(100) NOT NULL
);

CREATE TABLE T_CM_MOTO (
  id_moto NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  id_modelo NUMBER NOT NULL,
  id_filial_departamento NUMBER NOT NULL,
  nm_placa VARCHAR2(10) NOT NULL UNIQUE,
  st_moto VARCHAR2(30),
  km_rodado NUMBER(9),
  CONSTRAINT fk_moto_modelo FOREIGN KEY (id_modelo) REFERENCES T_CM_MODELO(id_modelo),
  CONSTRAINT fk_moto_filial FOREIGN KEY (id_filial_departamento) REFERENCES T_CM_FILIAL_DEPARTAMENTO(id_filial_departamento)
);

CREATE TABLE T_CM_CLIENTE (
  id_cliente NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nm_cliente VARCHAR2(100) NOT NULL,
  nr_cpf VARCHAR2(14) UNIQUE NOT NULL,
  nm_email VARCHAR2(100) UNIQUE NOT NULL
);

CREATE TABLE T_CM_ALUGUEL (
  id_aluguel NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  id_cliente NUMBER NOT NULL,
  id_moto NUMBER NOT NULL,
  dt_retirada TIMESTAMP NOT NULL,
  dt_devolucao TIMESTAMP NULL,
  CONSTRAINT fk_aluguel_cliente FOREIGN KEY (id_cliente) REFERENCES T_CM_CLIENTE(id_cliente),
  CONSTRAINT fk_aluguel_moto FOREIGN KEY (id_moto) REFERENCES T_CM_MOTO(id_moto)
);